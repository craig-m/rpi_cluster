#!/bin/bash
# {{ ansible_managed }}

logger -t rpicluster "lansrv-cron-hourly.sh started"

# pre-run checks ---------------------------------------------------------------

# only run as root
id | grep "uid=0(root)" || exit 1;

# no LD_PRELOAD
unset LD_PRELOAD

#-------------------------------------------------------------------------------

date > /mnt/ramstore/data/hour_check.txt

#-------------------------------------------------------------------------------

# sleep
sleep 5m;

# check process count
/usr/lib/nagios/plugins/check_procs -w 200 -c 300;

# check user count
/usr/lib/nagios/plugins/check_users -w 5 -c 10

logger -t rpicluster "lansrv-cron-hourly.sh finished"

#-------------------------------------------------------------------------------
