---
# omegapyapi


# note: code runs from /opt/omegapyapi/app/
- name: copy omegapyapi code
  synchronize:
    src: ~/rpi_cluster/code/host-omega/omegapyapi
    dest: /srv/python/
  changed_when: False


- name: run omegapyapi installer sh
  script: install.sh
  args:
    chdir: /srv/python/omegapyapi
    creates: /opt/omegapyapi/omegapyapi.socket


- name: omegapyapi service started
  service:
    name: omegapyapi
    state: started
  become: yes


- name: omegapyapi enabled on boot
  service:
    name: omegapyapi
    enabled: yes
  become: yes
